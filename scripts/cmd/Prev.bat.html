<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>Prev.bat | Cordeiro's DEV</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>	
<link rel='apple-touch-icon' sizes='57x57' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-57x57.png'>
<link rel='apple-touch-icon' sizes='60x60' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-60x60.png'>
<link rel='apple-touch-icon' sizes='72x72' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-72x72.png'>
<link rel='apple-touch-icon' sizes='76x76' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-76x76.png'>
<link rel='apple-touch-icon' sizes='114x114' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-114x114.png'>
<link rel='apple-touch-icon' sizes='120x120' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-120x120.png'>
<link rel='apple-touch-icon' sizes='144x144' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-144x144.png'>
<link rel='apple-touch-icon' sizes='152x152' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-152x152.png'>
<link rel='apple-touch-icon' sizes='180x180' href='https://rodcordeiro.github.io/shares/favicons/game/apple-icon-180x180.png'>
<link rel='icon' type='image/png' sizes='192x192'  href='https://rodcordeiro.github.io/shares/favicons/game/android-icon-192x192.png'>
<link rel='icon' type='image/png' sizes='32x32' href='https://rodcordeiro.github.io/shares/favicons/game/favicon-32x32.png'>
<link rel='icon' type='image/png' sizes='96x96' href='https://rodcordeiro.github.io/shares/favicons/game/favicon-96x96.png'>
<link rel='icon' type='image/png' sizes='16x16' href='https://rodcordeiro.github.io/shares/favicons/game/favicon-16x16.png'>
<link rel='manifest' href='https://rodcordeiro.github.io/shares/favicons/game/manifest.json'>
<meta name='msapplication-TileImage' content='https://rodcordeiro.github.io/shares/favicons/game/ms-icon-144x144.png'>
<!-- Informações da página -->
	<!-- Informações sobre o Site quando o link é compartilhado-->
	<meta property='og:type' content='website'>
	<meta property='og:locale' content='pt_BR' />
	<meta property='og:image' content='https://rodcordeiro.github.io/shares/favicons/game/android-icon-192x192.png'>
	<meta property='og:site_name' content='Rodrigo Cordeiro | Cordeiro\'s DEV'>
	<meta property='og:title' content='Rodrigo Cordeiro | Cordeiro\'s DEV'>
	<meta property='og:determiner' content='the'>
	<meta property='og:url' content='https://rodcordeiro.github.io/shares/'>
	<meta property='og:description' content='Compartilhamento de livros, imagens, audios e scripts utilizados em meus projetos.'>
	<meta property='og:image:secure_url' content='https://rodcordeiro.github.io/shares/favicons/game/android-icon-192x192.png' />

	<meta name='twitter:card' content='summary' />
	<meta name='twitter:description' content='Compartilhamento de livros, imagens, audios e scripts utilizados em meus projetos.'/>
	<meta name='twitter:title' content='Rodrigo Cordeiro | Cordeiro\'s DEV' />
	<meta name='twitter:site' content='@drigocordeiro13' />
	<meta name='twitter:image' content='https://rodcordeiro.github.io/shares/favicons/game/android-icon-192x192.png' />
	<meta name='twitter:creator' content='@drigocordeiro13' />

	<link rel='prefetch' href='https://rodcordeiro.github.io/shares/'>
	<link rel='prerender' href='https://rodcordeiro.github.io/shares/'>
	<meta itemprop='name' content=' | Cordeiro\'s DEV' />
	<meta itemprop='url' content='https://rodcordeiro.github.io/shares/' />
	<meta property='description' content='Compartilhamento de livros, imagens, audios e scripts utilizados em meus projetos.'>

	<!-- Outros dados como o site, como permissão para indexação do site, faixa etária, idioma, etc. -->
	<link rel='home' href='https://rodcordeiro.github.io/shares/'>
	<meta name='keywords' content='html, css, js, javascript, código, programação, web, development, webdesign, devops,front-end,aprender, educação, aprendizado'>
	<meta name='robots' content='index, follow'>
	<meta name='revisit-after' content='1 day'>
	<meta name='rating' content='general'>
	<meta name='language' content='pt-br'>

	<!-- Informações sobre o Autor -->
	<meta property='author' content='Rodrigo Cordeiro'>
	<meta name='dc.creator.address' content='rodrigomendoncca@gmail.com'>

<!-- LINKS -->
<link rel='stylesheet' href='https://rodcordeiro.github.io/shares/scripts/css/highlight.css'>
<script src='https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.16.2/build/highlight.min.js'></script>
<script>hljs.initHighlightingOnLoad();</script>

</head>
<body>
<h3><a href='Prev.bat' download='Prev.bat'>Download item</a>  |  <a href='./'>Voltar<a/></h3>
<div>
<pre><code class='dos'>
﻿::**************************************************************************************************************************************************					
::NOME       : Preventiva					
::AUTOR      : Rodrigo Cordeiro					
::VERSION    : 4.0
::Release Note: 
::	- Incluido CCleaner para iniciar durante a preventiva;
::	- Configurado caminho para pasta no servidor do cliente Globo Master.
::	- Removido Eventvwr e inserido o 'Console.msc', para visualização de eventos (com atalho ara os erros configurado em 'Exibição personalizada') e visualização dos usuários;
::
::PENDENTE: Atualização dos caminhos das pastas no servidor dos clientes.					
::**************************************************************************************************************************************************					

:: Configurações de tela.					
::/==================================================================================================================					
:mode					
echo	off				
title	BELTIS SUPORTE - OUTSOURCING - INFRAESTRUTURA				
COLOR	0C				
::/==================================================================================================================					
cls					
echo: 	%date%	 %time%		
echo.					
echo.					
echo.					
echo.					
echo.	*************************************************************			
echo.		NAO SE ESQUECA DE EXECUTAR COMO ADMINISTRADOR 		
echo.	*************************************************************			
echo.					
echo.					
echo.					
TIMEOUT /T 2					
::/==================================================================================================================					
:prev
title BELTIS - Preventiva
color 0F

call :print
echo.	*************************************************************
echo.
echo.	       	  INICIANDO A PREVENTIVA 	
echo.	     
echo.	*************************************************************
echo.

timeout /t 1
goto :belarc

::/==================================================================================================================
:belarc
call :print
set /p option=Executar o Belarc? ([S]Sim/[N]Nao)
echo.
echo.

if %option% EQU S (
	call :bel
	) else if %option% EQU s (
	call :bel
	) else (
	call :Prev
	)
::/==================================================================================================================
:bel
call :print Belarc
echo. Iniciando belarc...
if exist "%programfiles(x86)%" (
	if exist "C:\Program Files (x86)\Belarc\BelarcAdvisor\" (
		cd "C:\Program Files (x86)\Belarc\BelarcAdvisor\"
		start BelarcAdvisor.exe
		call :Prev
		) else (
		cd "C:\Preventiva\"
		start advisorinstaller.exe
		timeout /t 15
		call :Prev
		)
		) else (
		if exist "C:\Program Files\Belarc\BelarcAdvisor\" (
			cd "C:\Program Files\Belarc\BelarcAdvisor\"
			start BelarcAdvisor.exe
			call :Prev
			) else (
			cd "C:\Preventiva\"
			start advisorinstaller.exe
			timeout /t 15
			call :Prev
			)
			)

::/==================================================================================================================
:Prev
echo.Efetuando Limpeza


call :print Limpeza
defrag -c -v >C:\Preventiva\result_defrag.txt
del /s /f /q c:\windows\temp\*.*
rd /s /q c:\windows\temp
md c:\windows\temp
del /s /f /q C:\WINDOWS\Prefetch
del /s /f /q %temp%\*.*
rd /s /q %temp%
md %temp%
rd /s /q c:\windows\tempor~1
rd /s /q c:\windows\temp
rd /s /q c:\windows\tmp
rd /s /q c:\ff*.tmp
rd /s /q %windir%\history
rd /s /q c:\windows\cookies
rd /s /q c:\windows\recent
rd /s /q c:\windows\spool\printers
rd /s /q %temp%
rd /s /q c:\windows\repair
rd /s /q c:\windows\system32\dllcache
rd /s /q c:\windows\Downloaded Installations
rd /s /q c:\MSOCache
rd /s /q c:\windows\Installer
rd /s /q c:\windows\system32\ReinstallBackups
del c:\WIN386.SWP
if not exist "C:\WINDOWS\Users\*.*" goto skip
if exist "C:\WINDOWS\Users\*.zip" del "C:\WINDOWS\Users\*.zip" /f /q
if exist "C:\WINDOWS\Users\*.exe" del "C:\WINDOWS\Users\*.exe" /f /q
if exist "C:\WINDOWS\Users\*.gif" del "C:\WINDOWS\Users\*.gif" /f /q
if exist "C:\WINDOWS\Users\*.jpg" del "C:\WINDOWS\Users\*.jpg" /f /q
if exist "C:\WINDOWS\Users\*.png" del "C:\WINDOWS\Users\*.png" /f /q
if exist "C:\WINDOWS\Users\*.bmp" del "C:\WINDOWS\Users\*.bmp" /f /q
if exist "C:\WINDOWS\Users\*.avi" del "C:\WINDOWS\Users\*.avi" /f /q
if exist "C:\WINDOWS\Users\*.mpg" del "C:\WINDOWS\Users\*.mpg" /f /q
if exist "C:\WINDOWS\Users\*.mpeg" del "C:\WINDOWS\Users\*.mpeg" /f /q
if exist "C:\WINDOWS\Users\*.ra" del "C:\WINDOWS\Users\*.ra" /f /q
if exist "C:\WINDOWS\Users\*.ram" del "C:\WINDOWS\Users\*.ram"/f /q
if exist "C:\WINDOWS\Users\*.mp3" del "C:\WINDOWS\Users\*.mp3" /f /q
if exist "C:\WINDOWS\Users\*.mov" del "C:\WINDOWS\Users\*.mov" /f /q
if exist "C:\WINDOWS\Users\*.qt" del "C:\WINDOWS\Users\*.qt" /f /q
if exist "C:\WINDOWS\Users\*.asf" del "C:\WINDOWS\Users\*.asf" /f /q
:skip
if not exist C:\WINDOWS\Users\Users\*.* goto skippy /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.zip del C:\WINDOWS\Users\Users\*.zip /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.exe del C:\WINDOWS\Users\Users\*.exe /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.gif del C:\WINDOWS\Users\Users\*.gif /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.jpg del C:\WINDOWS\Users\Users\*.jpg /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.png del C:\WINDOWS\Users\Users\*.png /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.bmp del C:\WINDOWS\Users\Users\*.bmp /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.avi del C:\WINDOWS\Users\Users\*.avi /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.mpg del C:\WINDOWS\Users\Users\*.mpg /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.mpeg del C:\WINDOWS\Users\Users\*.mpeg /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.ra del C:\WINDOWS\Users\Users\*.ra /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.ram del C:\WINDOWS\Users\Users\*.ram /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.mp3 del C:\WINDOWS\Users\Users\*.mp3 /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.asf del C:\WINDOWS\Users\Users\*.asf /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.qt del C:\WINDOWS\Users\Users\*.qt /f /q
if exist C:\WINDOWS\Users\AppData\Temp\*.mov del C:\WINDOWS\Users\Users\*.mov /f /q
:skippy
if exist "C:\WINDOWS\ff*.tmp" del C:\WINDOWS\ff*.tmp /f /q
if exist C:\WINDOWS\ShellIconCache del /f /q "C:\WINDOWS\ShellI~1\*.*"
rd /s c:\$Recycle.Bin
%windir%\system32\rundll32.exe advapi32.dll,ProcessIdleTasks
cls
echo.
echo.
echo.
echo.
echo.
echo.
echo.
echo.
echo.	************************************************
echo.
echo.	       LIMPEZA EFETUADA COM SUCESSO.
echo.
echo.	************************************************


::/==================================================================================================================
call :print Softwares
echo.Iniciando Softwares
ping localhost>nul

start eventvwr.msc
start appwiz.cpl
start Inetcpl.cpl
start wuapp.exe
start msconfig
start C:\Preventiva\diskinfo.exe
start C:\Preventiva\CCLeaner.exe
start C:\Preventiva\BlueScreenView.exe


::/==================================================================================================================
call :print Usuario local Beltis

echo.
set /p option= Atualizar usuario local Beltis? ([S]Sim/[N]Nao)
echo.
echo.

if %option% EQU S (
	call :user
	) else if %option% EQU s (
	call :user
	) else (
	call :TeamViewer
	)
	:user
	call :pd
	echo. *ATUALIZANDO USUARIO
	timeout /t 1
	net user beltis %passwd%
	net user beltis %passwd% /add /comment:"Usuario local administrativo utilizado para suporte"
	net localgroup administradores beltis /add
	net localgroup administrators beltis /add
	CLS
	echo.
	echo.
	echo.	************************************************
	echo.
	echo.	       USUARIO ATUALIZADO COM SUCESSO!
	echo.
	echo.	************************************************
	ping localhost>nul
::/==================================================================================================================
:TeamViewer

call :print TeamViewer
if exist "%programfiles(x86)%" (
	cd "C:\Program Files (x86)\TeamViewer\"
	if not exist "TeamViewer12_Logfile.log" (
		net stop TeamViewer 
		"%programfiles(x86)%\TeamViewer\uninstall.exe" /S
		timeout /t 10
		start C:\Preventiva\TeamViewer_Setup.exe
		schtasks /create /sc onlogon /tn TeamViewer /tr "%programfiles(x86)%\TeamViewer\TeamViewer.exe" /f /rl highest
		exit
		) else if not exist "C:\Program Files (x86)\TeamViewer\" (
		start C:\Preventiva\TeamViewer_Setup.exe
		schtasks /create /sc onlogon /tn TeamViewer /tr "%programfiles(x86)%\TeamViewer\TeamViewer.exe" /f /rl highest
		exit
		) else (
		echo.	************************************************
		echo.
		echo.	       TEAMVIEWER CORRETO INSTALADO!
		echo.
		echo.	************************************************
		timeout /t 1
		exit	
		)
		) else (
		cd "C:\Program Files\TeamViewer\"
		if not exist "TeamViewer12_Logfile.log" (
			net stop TeamViewer 
			"%programfiles%\TeamViewer\uninstall.exe" /S
			timeout /t 10
			start C:\Preventiva\TeamViewer_Setup.exe
			schtasks /create /sc onlogon /tn TeamViewer /tr "%programfiles%\TeamViewer\TeamViewer.exe" /f /rl highest
			exit
			) else if not exist "C:\Program Files (x86)\TeamViewer\" (
			start C:\Preventiva\TeamViewer_Setup.exe
			exit
			) else (
			echo.	************************************************
			echo.
			echo.	       TEAMVIEWER CORRETO INSTALADO!
			echo.
			echo.	************************************************
			timeout /t 1
			exit	
			)
			)

::/==================================================================================================================
:print

cls
echo: 	%date%	 %time%
echo: DOMINIO: %userdomain%    USUARIO: %username%      COMPUTADOR: %computername%
echo: 
echo: 
echo: 
echo:%*
echo:

goto :eof

:pd
set passwd=suporte@2018
set passwd=suporte@2019
</code></pre>
</div>
</body>
</html>
